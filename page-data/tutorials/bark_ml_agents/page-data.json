{"componentChunkName":"component---src-templates-tutorials-js","path":"/tutorials/bark_ml_agents/","result":{"data":{"markdownRemark":{"html":"<p>BARK-ML offers a variety of reinforcement learning agents to learn behavior policies for autonomous vehicles.\nIn this tutorial, a soft actor-critic agent based on the <a href=\"#\" class=\"aggBlueText\">TensorFlow Agents</a> library is used that learns to merge lanes.\n<br />\n<br /></p>\n<p>First, the environment is set up where the agent should learn to behave in:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> gym\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token comment\"># registers bark-ml environments</span>\n<span class=\"token keyword\">import</span> bark_ml<span class=\"token punctuation\">.</span>environments<span class=\"token punctuation\">.</span>gym  <span class=\"token comment\"># pylint: disable=unused-import</span>\n<span class=\"token comment\"># import agent and runner</span>\n<span class=\"token keyword\">from</span> bark_ml<span class=\"token punctuation\">.</span>library_wrappers<span class=\"token punctuation\">.</span>lib_tf_agents<span class=\"token punctuation\">.</span>agents <span class=\"token keyword\">import</span> BehaviorSACAgent\n<span class=\"token keyword\">from</span> bark_ml<span class=\"token punctuation\">.</span>library_wrappers<span class=\"token punctuation\">.</span>lib_tf_agents<span class=\"token punctuation\">.</span>runners <span class=\"token keyword\">import</span> SACRunner\n<span class=\"token comment\"># to handle parameters</span>\n<span class=\"token keyword\">from</span> bark<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>commons<span class=\"token punctuation\">.</span>parameters <span class=\"token keyword\">import</span> ParameterServer\n\n<span class=\"token comment\"># load gym environment</span>\nenv <span class=\"token operator\">=</span> gym<span class=\"token punctuation\">.</span>make<span class=\"token punctuation\">(</span><span class=\"token string\">\"merging-v0\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br />\n<p>However, the runtime is not used as each <code class=\"language-text\">Agent</code> in BARK-ML provides a runner that runs a specified number of scenarios.</p>\n<p>All the code that is required for learning a behavior is outlined below:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># params = ParameterServer(filename=\"tfa_params.json\")</span>\nparams <span class=\"token operator\">=</span> ParameterServer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsac_agent <span class=\"token operator\">=</span> BehaviorSACAgent<span class=\"token punctuation\">(</span>environment<span class=\"token operator\">=</span>env<span class=\"token punctuation\">,</span>\n                             params<span class=\"token operator\">=</span>params<span class=\"token punctuation\">)</span>\nenv<span class=\"token punctuation\">.</span>ml_behavior <span class=\"token operator\">=</span> sac_agent\n<span class=\"token comment\"># runner either trains, evaluates or visualized the agent</span>\nrunner <span class=\"token operator\">=</span> SACRunner<span class=\"token punctuation\">(</span>params<span class=\"token operator\">=</span>params<span class=\"token punctuation\">,</span>\n                   environment<span class=\"token operator\">=</span>env<span class=\"token punctuation\">,</span>\n                   agent<span class=\"token operator\">=</span>sac_agent<span class=\"token punctuation\">)</span></code></pre></div>\n<br />\n<p>All that remains is to first train and then visualize the <code class=\"language-text\">BehaviorSACAgent</code> using:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">runner<span class=\"token punctuation\">.</span>Train<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nrunner<span class=\"token punctuation\">.</span>Run<span class=\"token punctuation\">(</span>num_episodes<span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> render<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>BARK-ML provides several state-of-the-art agents ranging from the proximal policy optimization (PPO) to the soft actor-critic (SAC) algorithms.</p>","frontmatter":{"title":"Training BARK-ML Agents"}}},"pageContext":{"slug":"/tutorials/bark_ml_agents/"}},"staticQueryHashes":["1503014085","3885506533","4018511916","63159454"]}